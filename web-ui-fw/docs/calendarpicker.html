<!DOCTYPE html>  <html> <head>   <title>calendarpicker.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               calendarpicker.js             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * jQuery Mobile Widget @VERSION</span>
<span class="cm"> *</span>
<span class="cm"> * This software is licensed under the MIT licence (as defined by the OSI at</span>
<span class="cm"> * http://www.opensource.org/licenses/mit-license.php)</span>
<span class="cm"> * </span>
<span class="cm"> * ***************************************************************************</span>
<span class="cm"> * Copyright (C) 2011 by Intel Corporation Ltd.</span>
<span class="cm"> * </span>
<span class="cm"> * Permission is hereby granted, free of charge, to any person obtaining a</span>
<span class="cm"> * copy of this software and associated documentation files (the &quot;Software&quot;),</span>
<span class="cm"> * to deal in the Software without restriction, including without limitation</span>
<span class="cm"> * the rights to use, copy, modify, merge, publish, distribute, sublicense,</span>
<span class="cm"> * and/or sell copies of the Software, and to permit persons to whom the</span>
<span class="cm"> * Software is furnished to do so, subject to the following conditions:</span>
<span class="cm"> * </span>
<span class="cm"> * The above copyright notice and this permission notice shall be included in</span>
<span class="cm"> * all copies or substantial portions of the Software.</span>
<span class="cm"> * </span>
<span class="cm"> * THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span>
<span class="cm"> * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span>
<span class="cm"> * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span>
<span class="cm"> * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span>
<span class="cm"> * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING</span>
<span class="cm"> * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER</span>
<span class="cm"> * DEALINGS IN THE SOFTWARE.</span>
<span class="cm"> * ***************************************************************************</span>
<span class="cm"> *</span>
<span class="cm"> * Authors: Kalyan Kondapally &lt;kalyan.kondapally@intel.com&gt;</span>
<span class="cm"> */</span></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>CalendarPicker can be created using the calendarpicker() method or by adding a
data-role="calendarpicker" attribute to an element.
The core logic of the widget has been taken from https://github.com/jtsage/jquery-mobile-datebox</p>

<p>CalendarPicker is hidden by default.It can be displayed by calling open() or setting option "show" to true
during creation and close() to hide it. It appears as a popup window and disappears when closed.
CalendarPicker closes automatically when a valid date selection has been made, or when the user clicks
outside its box.</p>

<p>Options:</p>

<pre><code>dateFormat: The format of date. The Default value is YYYY-MM-DD.

calShowDays: Default value is true. Should be set to false if name of the day should not be displayed.
calShowOnlyMonth: Default Value is true. Should be set to false if previous or next month dates should be visible
                   along with the current month.
highDays: An array of days to highlight, every week followed by the theme used to hightlight them.
          Sun = Sunday, Mon = Monday, ... Sat = Saturday (e.g. ["Sun","b", "Sat", "mycustomtheme"])
disabledDayColor: Colour used to show disabled dates.
calHighToday: Theme used to highlight current day. By default it is set to e.Setting the value to null will disable
              highlighting todays date.
highDatesTheme: The theme used to highlight dates specified by highDates option.By default it is theme e.
calStartDay: Defines the start day of the week. By default it is 1(Monday).

FOllowing documentation taken from http://dev.jtsage.com/#/jQM-DateBox/demos/calendar/ :

afterToday: When set, only dates that are after or on "today" are selectable.
beforeToday: When set, only dates that are before or on "today" are selectable.
notToday: When set, "today" is not selectable.
minDays: When set, only dates that are after *number* of days before today may be selected.
         Note that minDays can be a negative number.
maxDays: When set, only dates that are before *number* of days after today may be selected.
         Note that maxDays can be a negative number.
highDates: An array of ISO 8601 Dates to highlight. (e.g. ["2011-01-01", "2011-12-25"]).
blackDays: An array of days to disable, every week. 0 = Sunday, 1 = Monday, ... 6 = Saturday (e.g. [2]).
blackDates: An array of ISO 8601 Dates to disable. (e.g. ["2011-01-01", "2011-12-25"]).
Using a calendar to select a specific day can be accomplished by setting option 'calWeekMode' to 'true'
and 'calWeekModeFirstDay' to the day you wish to pick.
</code></pre>

<p>Events:</p>

<pre><code>appear: Fired after calendarpicker becomes visible and appear animation has ended.
disappear: Fired after calendarpicker is closed and disappear animation has ended.
selectedDate: Fired after user has selected a valid date. The formateddate(which user has selected)
              is sent as additional parameter.
</code></pre>

<p>Properties:</p>

<pre><code>open: Shows the CalendarPicker with an animation.
close: Hides the CalendarPicker with an animation.
visible: Returns true if calendarpicker is visible.
Refresh: Recalculates the needed buttons to display dates.It can be useful in cases like orientation change,
         changing options dynamically etc.
</code></pre>

<p>Examples:</p>

<pre><code>HTML markup for creating CalendarPicker:
    &lt;div id = "calendarbutton" data-role = "calendarpicker"&gt;  &lt;/div&gt;

How to Show CalendarPicker (for example when user presses a button):
    &lt;div id = "calendarbutton" data-role = "calendarpicker"&gt;
        &lt;a href="#" data-role="button" data-theme = "a" data-inline = true data-corners=false&gt;
           Launch CalendarPicker&lt;/a&gt;
    &lt;/div&gt;
   $(document).bind("pagecreate", function() {
       var button = $('#calendarbutton');
       button.bind('vclick', function (e) {
      button.calendarpicker('open'); --&gt; Shows the CalendarPicker.
           button.unbind('selectedDate').bind('selectedDate',function(e,val) {
           // val should contain the selected date in specified format.
           });
       });
   });
</code></pre>

<p>How to Show CalendarPicker by default:
       <div id = "calendarbutton" data-role = "calendarpicker" data-options='{"show": "true"}'>  </div></p>

<p>Passing custom options:
        <div id = "calendarbutton" data-role = "calendarpicker" data-options='{"calShowOnlyMonth": "false"}'>  </div>
        <div id = "calendarbutton" data-role = "calendarpicker" data-options='{"highDays": ["Mon","e","Wed","a"]}'></div>
        <div id = "calendarbutton" data-role = "calendarpicker" data-options='{"highDates": ["2011-12-24", "2011-12-25"],
                                                                               "highDatesTheme":"c"}'>  </div></p>

<p>To select by week using Wednesday:
       <div id = "calendarbutton" data-role = "calendarpicker" data-options='{"calWeekMode": true,
                                                                              "calWeekModeFirstDay": 3}'>  </div>
   To change startday of the week to be Sunday:
       <div id = "calendarbutton" data-role = "calendarpicker" data-options='{"calStartDay": 0}'>  </div></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">$</span><span class="p">,</span> <span class="kc">undefined</span> <span class="p">)</span> <span class="p">{</span>
    <span class="nx">$</span><span class="p">.</span><span class="nx">widget</span><span class="p">(</span> <span class="s2">&quot;todons.calendarpicker&quot;</span><span class="p">,</span> <span class="nx">$</span><span class="p">.</span><span class="nx">todons</span><span class="p">.</span><span class="nx">widgetex</span><span class="p">,</span> <span class="p">{</span>
        <span class="nx">options</span><span class="o">:</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>All widget options, including some internal runtime details</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nx">daysOfWeekShort</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;Sun&#39;</span><span class="p">,</span> <span class="s1">&#39;Mon&#39;</span><span class="p">,</span> <span class="s1">&#39;Tue&#39;</span><span class="p">,</span> <span class="s1">&#39;Wed&#39;</span><span class="p">,</span> <span class="s1">&#39;Thu&#39;</span><span class="p">,</span> <span class="s1">&#39;Fri&#39;</span><span class="p">,</span> <span class="s1">&#39;Sat&#39;</span><span class="p">],</span>
            <span class="nx">monthsOfYear</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;January&#39;</span><span class="p">,</span> <span class="s1">&#39;February&#39;</span><span class="p">,</span> <span class="s1">&#39;March&#39;</span><span class="p">,</span> <span class="s1">&#39;April&#39;</span><span class="p">,</span> <span class="s1">&#39;May&#39;</span><span class="p">,</span> <span class="s1">&#39;June&#39;</span><span class="p">,</span> <span class="s1">&#39;July&#39;</span><span class="p">,</span> <span class="s1">&#39;August&#39;</span><span class="p">,</span> <span class="s1">&#39;September&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;October&#39;</span><span class="p">,</span> <span class="s1">&#39;November&#39;</span><span class="p">,</span> <span class="s1">&#39;December&#39;</span><span class="p">],</span>
            <span class="nx">calShowDays</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="nx">calShowOnlyMonth</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="nx">dateFormat</span><span class="o">:</span> <span class="s1">&#39;YYYY-MM-DD&#39;</span><span class="p">,</span>
            <span class="nx">calWeekMode</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
            <span class="nx">calWeekModeFirstDay</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="nx">calStartDay</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="nx">notToday</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span>
            <span class="nx">afterToday</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
            <span class="nx">beforeToday</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
            <span class="nx">maxDays</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
            <span class="nx">minDays</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
            <span class="nx">highDays</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;Sun&quot;</span><span class="p">,</span><span class="s2">&quot;firstdaybutton&quot;</span><span class="p">,</span> <span class="s2">&quot;Sat&quot;</span><span class="p">,</span><span class="s2">&quot;lastdaybutton&quot;</span><span class="p">],</span>
            <span class="nx">calHighToday</span><span class="o">:</span> <span class="s2">&quot;e&quot;</span><span class="p">,</span>
            <span class="nx">highDates</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
            <span class="nx">highDatesTheme</span><span class="o">:</span><span class="s2">&quot;e&quot;</span><span class="p">,</span>
            <span class="nx">blackDays</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
            <span class="nx">blackDates</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
            <span class="nx">disabledDayColor</span><span class="o">:</span> <span class="s1">&#39;#888&#39;</span><span class="p">,</span>
            <span class="nx">show</span><span class="o">:</span> <span class="kc">false</span>
        <span class="p">},</span>

        <span class="nx">_zeroPad</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">number</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>Pad a number with a zero, to make it 2 digits</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="k">return</span> <span class="p">(</span> <span class="p">(</span> <span class="nx">number</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;0&quot;</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span> <span class="p">)</span> <span class="o">+</span> <span class="nb">String</span><span class="p">(</span><span class="nx">number</span><span class="p">);</span>
        <span class="p">},</span>

        <span class="nx">_makeOrd</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">num</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>Return an ordinal suffix (1st, 2nd, 3rd, etc)</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="kd">var</span> <span class="nx">ending</span> <span class="o">=</span> <span class="nx">num</span> <span class="o">%</span> <span class="mi">10</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span> <span class="nx">num</span> <span class="o">&gt;</span> <span class="mi">9</span> <span class="o">&amp;&amp;</span> <span class="nx">num</span> <span class="o">&lt;</span> <span class="mi">21</span> <span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="s1">&#39;th&#39;</span><span class="p">;</span> <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span> <span class="nx">ending</span> <span class="o">&gt;</span> <span class="mi">3</span> <span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="s1">&#39;th&#39;</span><span class="p">;</span> <span class="p">}</span>
            <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;th&#39;</span><span class="p">,</span><span class="s1">&#39;st&#39;</span><span class="p">,</span><span class="s1">&#39;nd&#39;</span><span class="p">,</span><span class="s1">&#39;rd&#39;</span><span class="p">][</span><span class="nx">ending</span><span class="p">];</span>
        <span class="p">},</span>

        <span class="nx">_dstAdjust</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">date</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>Make sure not to run into daylight savings time.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">date</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="kc">null</span><span class="p">;</span> <span class="p">}</span>
            <span class="nx">date</span><span class="p">.</span><span class="nx">setHours</span><span class="p">(</span><span class="nx">date</span><span class="p">.</span><span class="nx">getHours</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">12</span> <span class="o">?</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getHours</span><span class="p">()</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">:</span> <span class="mi">0</span><span class="p">);</span>
            <span class="k">return</span> <span class="nx">date</span><span class="p">;</span>
        <span class="p">},</span>

        <span class="nx">_getFirstDay</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">date</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>Get the first DAY of the month (0-6)</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="k">return</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">date</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">(),</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">(),</span> <span class="mi">1</span><span class="p">).</span><span class="nx">getDay</span><span class="p">();</span>
        <span class="p">},</span>

        <span class="nx">_getLastDate</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">date</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>Get the last DATE of the month (28,29,30,31)</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="k">return</span> <span class="mi">32</span> <span class="o">-</span> <span class="k">this</span><span class="p">.</span><span class="nx">_dstAdjust</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">date</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">(),</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">(),</span> <span class="mi">32</span><span class="p">)).</span><span class="nx">getDate</span><span class="p">();</span>
        <span class="p">},</span>

        <span class="nx">_getLastDateBefore</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">date</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>Get the last DATE of the PREVIOUS month (28,29,30,31)</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="k">return</span> <span class="mi">32</span> <span class="o">-</span> <span class="k">this</span><span class="p">.</span><span class="nx">_dstAdjust</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">date</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">(),</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">)).</span><span class="nx">getDate</span><span class="p">();</span>
        <span class="p">},</span>

        <span class="nx">_formatter</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">format</span><span class="p">,</span> <span class="nx">date</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>Format the output date or time (not duration)</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nx">format</span> <span class="o">=</span> <span class="nx">format</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">&#39;SS&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_makeOrd</span><span class="p">(</span><span class="nx">date</span><span class="p">.</span><span class="nx">getDate</span><span class="p">()));</span>
            <span class="nx">format</span> <span class="o">=</span> <span class="nx">format</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">&#39;YYYY&#39;</span><span class="p">,</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">());</span>
            <span class="nx">format</span> <span class="o">=</span> <span class="nx">format</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">&#39;MM&#39;</span><span class="p">,</span>   <span class="k">this</span><span class="p">.</span><span class="nx">_zeroPad</span><span class="p">(</span><span class="nx">date</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">));</span>
            <span class="nx">format</span> <span class="o">=</span> <span class="nx">format</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">&#39;mm&#39;</span><span class="p">,</span>   <span class="nx">date</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
            <span class="nx">format</span> <span class="o">=</span> <span class="nx">format</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">&#39;DD&#39;</span><span class="p">,</span>   <span class="k">this</span><span class="p">.</span><span class="nx">_zeroPad</span><span class="p">(</span><span class="nx">date</span><span class="p">.</span><span class="nx">getDate</span><span class="p">()));</span>
            <span class="nx">format</span> <span class="o">=</span> <span class="nx">format</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">&#39;dd&#39;</span><span class="p">,</span>   <span class="nx">date</span><span class="p">.</span><span class="nx">getDate</span><span class="p">());</span>
            <span class="k">return</span> <span class="nx">format</span><span class="p">;</span>
        <span class="p">},</span>

        <span class="nx">_formatDate</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">date</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>Shortcut function to return dateFormat date/time format</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_formatter</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">dateFormat</span><span class="p">,</span> <span class="nx">date</span><span class="p">);</span>
        <span class="p">},</span>

        <span class="nx">_isoDate</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">y</span><span class="p">,</span><span class="nx">m</span><span class="p">,</span><span class="nx">d</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>Return an ISO 8601 date (yyyy-mm-dd)</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="k">return</span> <span class="nb">String</span><span class="p">(</span><span class="nx">y</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="p">((</span> <span class="nx">m</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;0&quot;</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="nb">String</span><span class="p">(</span><span class="nx">m</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="p">((</span><span class="nx">d</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;0&quot;</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="nb">String</span><span class="p">(</span><span class="nx">d</span><span class="p">);</span>
        <span class="p">},</span>

        <span class="nx">_checker</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">date</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>Return a ISO 8601 BASIC format date (YYYYMMDD) for simple comparisons</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="k">return</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nb">String</span><span class="p">(</span><span class="nx">date</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">())</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">_zeroPad</span><span class="p">(</span><span class="nx">date</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">_zeroPad</span><span class="p">(</span><span class="nx">date</span><span class="p">.</span><span class="nx">getDate</span><span class="p">()),</span><span class="mi">10</span><span class="p">);</span>
        <span class="p">},</span>

        <span class="nx">_offset</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">mode</span><span class="p">,</span> <span class="nx">amount</span><span class="p">,</span> <span class="nx">update</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <p>Compute a date/time.
  update = false to prevent controls refresh</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">,</span>
            <span class="nx">o</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">;</span>

            <span class="k">if</span> <span class="p">(</span> <span class="k">typeof</span><span class="p">(</span><span class="nx">update</span><span class="p">)</span> <span class="o">===</span> <span class="s2">&quot;undefined&quot;</span> <span class="p">)</span> <span class="p">{</span> <span class="nx">update</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span> <span class="p">}</span>
            <span class="k">switch</span><span class="p">(</span><span class="nx">mode</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">case</span> <span class="s1">&#39;y&#39;</span><span class="o">:</span>
                 <span class="nx">self</span><span class="p">.</span><span class="nx">theDate</span><span class="p">.</span><span class="nx">setYear</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">theDate</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">()</span> <span class="o">+</span> <span class="nx">amount</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="s1">&#39;m&#39;</span><span class="o">:</span>
                <span class="nx">self</span><span class="p">.</span><span class="nx">theDate</span><span class="p">.</span><span class="nx">setMonth</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">theDate</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span> <span class="o">+</span> <span class="nx">amount</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="s1">&#39;d&#39;</span><span class="o">:</span>
                <span class="nx">self</span><span class="p">.</span><span class="nx">theDate</span><span class="p">.</span><span class="nx">setDate</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">theDate</span><span class="p">.</span><span class="nx">getDate</span><span class="p">()</span> <span class="o">+</span> <span class="nx">amount</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span> <span class="nx">update</span> <span class="o">===</span> <span class="kc">true</span> <span class="p">)</span> <span class="p">{</span> <span class="nx">self</span><span class="p">.</span><span class="nx">_update</span><span class="p">();</span> <span class="p">}</span>
        <span class="p">},</span>

        <span class="nx">_update</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>Update the display on date change</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">,</span>
                <span class="nx">o</span> <span class="o">=</span> <span class="nx">self</span><span class="p">.</span><span class="nx">options</span><span class="p">,</span>
                <span class="nx">testDate</span> <span class="o">=</span> <span class="kc">null</span><span class="p">,</span>
                <span class="nx">i</span><span class="p">,</span> <span class="nx">gridWeek</span><span class="p">,</span> <span class="nx">gridDay</span><span class="p">,</span> <span class="nx">skipThis</span><span class="p">,</span> <span class="nx">thisRow</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">cTheme</span><span class="p">,</span> <span class="nx">inheritDate</span><span class="p">,</span> <span class="nx">thisPRow</span><span class="p">,</span> <span class="nx">tmpVal</span><span class="p">,</span>
                <span class="nx">interval</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;d&#39;</span><span class="o">:</span> <span class="mi">60</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">24</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="o">:</span> <span class="mi">60</span><span class="o">*</span><span class="mi">60</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span><span class="o">:</span> <span class="mi">60</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="o">:</span><span class="mi">1</span><span class="p">},</span>
                <span class="nx">calmode</span> <span class="o">=</span> <span class="p">{};</span>

            <span class="nx">self</span><span class="p">.</span><span class="nx">_ui</span><span class="p">.</span><span class="nx">cpMonthGrid</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span> <span class="nx">o</span><span class="p">.</span><span class="nx">monthsOfYear</span><span class="p">[</span><span class="nx">self</span><span class="p">.</span><span class="nx">theDate</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()]</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nx">self</span><span class="p">.</span><span class="nx">theDate</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">()</span> <span class="p">);</span>
            <span class="nx">self</span><span class="p">.</span><span class="nx">_ui</span><span class="p">.</span><span class="nx">cpweekDayGrid</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>

            <span class="nx">calmode</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;today&#39;</span><span class="o">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;highlightDay&#39;</span><span class="o">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;presetDay&#39;</span><span class="o">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;nexttoday&#39;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s1">&#39;thisDate&#39;</span><span class="o">:</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span> <span class="s1">&#39;maxDate&#39;</span><span class="o">:</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span> <span class="s1">&#39;minDate&#39;</span><span class="o">:</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span>
                <span class="s1">&#39;currentMonth&#39;</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span> <span class="s1">&#39;weekMode&#39;</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;weekDays&#39;</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span> <span class="s1">&#39;thisTheme&#39;</span><span class="o">:</span> <span class="nx">o</span><span class="p">.</span><span class="nx">pickPageButtoTheme</span> <span class="p">};</span>
            <span class="nx">calmode</span><span class="p">.</span><span class="nx">start</span> <span class="o">=</span> <span class="nx">self</span><span class="p">.</span><span class="nx">_getFirstDay</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">theDate</span><span class="p">);</span>
            <span class="nx">calmode</span><span class="p">.</span><span class="nx">end</span> <span class="o">=</span> <span class="nx">self</span><span class="p">.</span><span class="nx">_getLastDate</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">theDate</span><span class="p">);</span>
            <span class="nx">calmode</span><span class="p">.</span><span class="nx">lastend</span> <span class="o">=</span> <span class="nx">self</span><span class="p">.</span><span class="nx">_getLastDateBefore</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">theDate</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span> <span class="nx">o</span><span class="p">.</span><span class="nx">calStartDay</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">{</span>
                <span class="nx">calmode</span><span class="p">.</span><span class="nx">start</span> <span class="o">=</span> <span class="nx">calmode</span><span class="p">.</span><span class="nx">start</span> <span class="o">-</span> <span class="nx">o</span><span class="p">.</span><span class="nx">calStartDay</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span> <span class="nx">calmode</span><span class="p">.</span><span class="nx">start</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">{</span> <span class="nx">calmode</span><span class="p">.</span><span class="nx">start</span> <span class="o">=</span> <span class="nx">calmode</span><span class="p">.</span><span class="nx">start</span> <span class="o">+</span> <span class="mi">7</span><span class="p">;</span> <span class="p">}</span>
            <span class="p">}</span>
            <span class="nx">calmode</span><span class="p">.</span><span class="nx">prevtoday</span> <span class="o">=</span> <span class="nx">calmode</span><span class="p">.</span><span class="nx">lastend</span> <span class="o">-</span> <span class="p">(</span><span class="nx">calmode</span><span class="p">.</span><span class="nx">start</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
            <span class="nx">calmode</span><span class="p">.</span><span class="nx">checkDates</span> <span class="o">=</span> <span class="p">(</span> <span class="nx">o</span><span class="p">.</span><span class="nx">afterToday</span> <span class="o">!==</span> <span class="kc">false</span> <span class="o">||</span> <span class="nx">o</span><span class="p">.</span><span class="nx">beforeToday</span> <span class="o">!==</span> <span class="kc">false</span> <span class="o">||</span> <span class="nx">o</span><span class="p">.</span><span class="nx">notToday</span> <span class="o">!==</span> <span class="kc">false</span> <span class="o">||</span> <span class="nx">o</span><span class="p">.</span><span class="nx">maxDays</span> <span class="o">!==</span> <span class="kc">false</span> <span class="o">||</span> <span class="nx">o</span><span class="p">.</span><span class="nx">minDays</span> <span class="o">!==</span> <span class="kc">false</span> <span class="o">||</span> <span class="nx">o</span><span class="p">.</span><span class="nx">blackDates</span> <span class="o">!==</span> <span class="kc">false</span> <span class="o">||</span> <span class="nx">o</span><span class="p">.</span><span class="nx">blackDays</span> <span class="o">!==</span> <span class="kc">false</span> <span class="p">);</span>

            <span class="k">if</span> <span class="p">(</span> <span class="nx">calmode</span><span class="p">.</span><span class="nx">thisDate</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span> <span class="o">===</span> <span class="nx">self</span><span class="p">.</span><span class="nx">theDate</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="nx">calmode</span><span class="p">.</span><span class="nx">thisDate</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">()</span> <span class="o">===</span> <span class="nx">self</span><span class="p">.</span><span class="nx">theDate</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">()</span> <span class="p">)</span> <span class="p">{</span> <span class="nx">calmode</span><span class="p">.</span><span class="nx">currentMonth</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span> <span class="nx">calmode</span><span class="p">.</span><span class="nx">highlightDay</span> <span class="o">=</span> <span class="nx">calmode</span><span class="p">.</span><span class="nx">thisDate</span><span class="p">.</span><span class="nx">getDate</span><span class="p">();</span> <span class="p">}</span>

            <span class="nx">self</span><span class="p">.</span><span class="nx">calNoPrev</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span> <span class="nx">self</span><span class="p">.</span><span class="nx">calNoNext</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

            <span class="k">if</span> <span class="p">(</span> <span class="nx">o</span><span class="p">.</span><span class="nx">afterToday</span> <span class="o">===</span> <span class="kc">true</span> <span class="o">&amp;&amp;</span>
                <span class="p">(</span> <span class="nx">calmode</span><span class="p">.</span><span class="nx">currentMonth</span> <span class="o">===</span> <span class="kc">true</span> <span class="o">||</span> <span class="p">(</span> <span class="nx">calmode</span><span class="p">.</span><span class="nx">thisDate</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="nx">self</span><span class="p">.</span><span class="nx">theDate</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="nx">self</span><span class="p">.</span><span class="nx">theDate</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">()</span> <span class="o">===</span> <span class="nx">calmode</span><span class="p">.</span><span class="nx">thisDate</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">()</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
                <span class="nx">self</span><span class="p">.</span><span class="nx">calNoPrev</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span> <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span> <span class="nx">o</span><span class="p">.</span><span class="nx">beforeToday</span> <span class="o">===</span> <span class="kc">true</span> <span class="o">&amp;&amp;</span>
                <span class="p">(</span> <span class="nx">calmode</span><span class="p">.</span><span class="nx">currentMonth</span> <span class="o">===</span> <span class="kc">true</span> <span class="o">||</span> <span class="p">(</span> <span class="nx">calmode</span><span class="p">.</span><span class="nx">thisDate</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="nx">self</span><span class="p">.</span><span class="nx">theDate</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="nx">self</span><span class="p">.</span><span class="nx">theDate</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">()</span> <span class="o">===</span> <span class="nx">calmode</span><span class="p">.</span><span class="nx">thisDate</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">()</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
                <span class="nx">self</span><span class="p">.</span><span class="nx">calNoNext</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span> <span class="p">}</span>

            <span class="k">if</span> <span class="p">(</span> <span class="nx">o</span><span class="p">.</span><span class="nx">minDays</span> <span class="o">!==</span> <span class="kc">false</span> <span class="p">)</span> <span class="p">{</span>
                <span class="nx">calmode</span><span class="p">.</span><span class="nx">minDate</span><span class="p">.</span><span class="nx">setDate</span><span class="p">(</span><span class="nx">calmode</span><span class="p">.</span><span class="nx">minDate</span><span class="p">.</span><span class="nx">getDate</span><span class="p">()</span> <span class="o">-</span> <span class="nx">o</span><span class="p">.</span><span class="nx">minDays</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span> <span class="nx">self</span><span class="p">.</span><span class="nx">theDate</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">()</span> <span class="o">===</span> <span class="nx">calmode</span><span class="p">.</span><span class="nx">minDate</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="nx">self</span><span class="p">.</span><span class="nx">theDate</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="nx">calmode</span><span class="p">.</span><span class="nx">minDate</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span> <span class="p">)</span> <span class="p">{</span> <span class="nx">self</span><span class="p">.</span><span class="nx">calNoPrev</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;}</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span> <span class="nx">o</span><span class="p">.</span><span class="nx">maxDays</span> <span class="o">!==</span> <span class="kc">false</span> <span class="p">)</span> <span class="p">{</span>
                <span class="nx">calmode</span><span class="p">.</span><span class="nx">maxDate</span><span class="p">.</span><span class="nx">setDate</span><span class="p">(</span><span class="nx">calmode</span><span class="p">.</span><span class="nx">maxDate</span><span class="p">.</span><span class="nx">getDate</span><span class="p">()</span> <span class="o">+</span> <span class="nx">o</span><span class="p">.</span><span class="nx">maxDays</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span> <span class="nx">self</span><span class="p">.</span><span class="nx">theDate</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">()</span> <span class="o">===</span> <span class="nx">calmode</span><span class="p">.</span><span class="nx">maxDate</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="nx">self</span><span class="p">.</span><span class="nx">theDate</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="nx">calmode</span><span class="p">.</span><span class="nx">maxDate</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span> <span class="p">)</span> <span class="p">{</span> <span class="nx">self</span><span class="p">.</span><span class="nx">calNoNext</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;}</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="p">(</span> <span class="nx">o</span><span class="p">.</span><span class="nx">calShowDays</span> <span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span> <span class="nx">o</span><span class="p">.</span><span class="nx">daysOfWeekShort</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;</span> <span class="mi">8</span> <span class="p">)</span> <span class="p">{</span> <span class="nx">o</span><span class="p">.</span><span class="nx">daysOfWeekShort</span> <span class="o">=</span> <span class="nx">o</span><span class="p">.</span><span class="nx">daysOfWeekShort</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">o</span><span class="p">.</span><span class="nx">daysOfWeekShort</span><span class="p">);</span> <span class="p">}</span>
                <span class="nx">calmode</span><span class="p">.</span><span class="nx">weekDays</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;&lt;div&gt;&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="o">:</span><span class="s1">&#39;ui-cp-row&#39;</span><span class="p">}).</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">_ui</span><span class="p">.</span><span class="nx">cpweekDayGrid</span><span class="p">);</span>
                <span class="k">for</span> <span class="p">(</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;=</span><span class="mi">6</span><span class="p">;</span><span class="nx">i</span><span class="o">++</span> <span class="p">)</span> <span class="p">{</span>
                    <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;&lt;div&gt;&quot;</span><span class="o">+</span><span class="nx">o</span><span class="p">.</span><span class="nx">daysOfWeekShort</span><span class="p">[</span><span class="nx">i</span><span class="o">+</span><span class="nx">o</span><span class="p">.</span><span class="nx">calStartDay</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;&lt;/div&gt;&quot;</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="s1">&#39;ui-cp-date ui-cp-date-disabled ui-cp-month&#39;</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">calmode</span><span class="p">.</span><span class="nx">weekDays</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="k">for</span> <span class="p">(</span> <span class="nx">gridWeek</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">gridWeek</span><span class="o">&lt;=</span><span class="mi">5</span><span class="p">;</span> <span class="nx">gridWeek</span><span class="o">++</span> <span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span> <span class="nx">gridWeek</span> <span class="o">===</span> <span class="mi">0</span> <span class="o">||</span> <span class="p">(</span> <span class="nx">gridWeek</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">calmode</span><span class="p">.</span><span class="nx">today</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">calmode</span><span class="p">.</span><span class="nx">today</span> <span class="o">&lt;=</span> <span class="nx">calmode</span><span class="p">.</span><span class="nx">end</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
                    <span class="nx">thisRow</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;&lt;div&gt;&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="o">:</span> <span class="s1">&#39;ui-cp-row&#39;</span><span class="p">}).</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">_ui</span><span class="p">.</span><span class="nx">cpweekDayGrid</span><span class="p">);</span>
                    <span class="k">for</span> <span class="p">(</span> <span class="nx">gridDay</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">gridDay</span><span class="o">&lt;=</span><span class="mi">6</span><span class="p">;</span> <span class="nx">gridDay</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">if</span> <span class="p">(</span> <span class="nx">gridDay</span> <span class="o">===</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">{</span> <span class="nx">calmode</span><span class="p">.</span><span class="nx">weekMode</span> <span class="o">=</span> <span class="p">(</span> <span class="nx">calmode</span><span class="p">.</span><span class="nx">today</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="p">)</span> <span class="o">?</span> <span class="p">(</span><span class="nx">calmode</span><span class="p">.</span><span class="nx">prevtoday</span> <span class="o">-</span> <span class="nx">calmode</span><span class="p">.</span><span class="nx">lastend</span> <span class="o">+</span> <span class="nx">o</span><span class="p">.</span><span class="nx">calWeekModeFirstDay</span><span class="p">)</span> <span class="o">:</span> <span class="p">(</span><span class="nx">calmode</span><span class="p">.</span><span class="nx">today</span> <span class="o">+</span> <span class="nx">o</span><span class="p">.</span><span class="nx">calWeekModeFirstDay</span><span class="p">);</span> <span class="p">}</span>
                        <span class="k">if</span> <span class="p">(</span> <span class="nx">gridDay</span> <span class="o">===</span> <span class="nx">calmode</span><span class="p">.</span><span class="nx">start</span> <span class="o">&amp;&amp;</span> <span class="nx">gridWeek</span> <span class="o">===</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">{</span> <span class="nx">calmode</span><span class="p">.</span><span class="nx">today</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="p">}</span>
                        <span class="k">if</span> <span class="p">(</span> <span class="nx">calmode</span><span class="p">.</span><span class="nx">today</span> <span class="o">&gt;</span> <span class="nx">calmode</span><span class="p">.</span><span class="nx">end</span> <span class="p">)</span> <span class="p">{</span> <span class="nx">calmode</span><span class="p">.</span><span class="nx">today</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="p">}</span>
                        <span class="k">if</span> <span class="p">(</span> <span class="nx">calmode</span><span class="p">.</span><span class="nx">today</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">{</span>
                            <span class="k">if</span> <span class="p">(</span> <span class="nx">o</span><span class="p">.</span><span class="nx">calShowOnlyMonth</span> <span class="p">)</span> <span class="p">{</span>
                                <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;&lt;div&gt;&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="o">:</span> <span class="s1">&#39;ui-cp-date ui-cp-date-disabled&#39;</span><span class="p">}).</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">thisRow</span><span class="p">);</span>
                            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                                <span class="k">if</span> <span class="p">(</span>
                                    <span class="p">(</span> <span class="nx">o</span><span class="p">.</span><span class="nx">blackDays</span> <span class="o">!==</span> <span class="kc">false</span> <span class="o">&amp;&amp;</span> <span class="nx">$</span><span class="p">.</span><span class="nx">inArray</span><span class="p">(</span><span class="nx">gridDay</span><span class="p">,</span> <span class="nx">o</span><span class="p">.</span><span class="nx">blackDays</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span> <span class="p">)</span> <span class="o">||</span>
                                    <span class="p">(</span> <span class="nx">o</span><span class="p">.</span><span class="nx">blackDates</span> <span class="o">!==</span> <span class="kc">false</span> <span class="o">&amp;&amp;</span> <span class="nx">$</span><span class="p">.</span><span class="nx">inArray</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">_isoDate</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">theDate</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">(),</span> <span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">theDate</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()),</span> <span class="nx">calmode</span><span class="p">.</span><span class="nx">prevtoday</span><span class="p">),</span> <span class="nx">o</span><span class="p">.</span><span class="nx">blackDates</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span> <span class="p">)</span> <span class="o">||</span>
                                    <span class="p">(</span> <span class="nx">o</span><span class="p">.</span><span class="nx">blackDates</span> <span class="o">!==</span> <span class="kc">false</span> <span class="o">&amp;&amp;</span> <span class="nx">$</span><span class="p">.</span><span class="nx">inArray</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">_isoDate</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">theDate</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">(),</span> <span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">theDate</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span><span class="o">+</span><span class="mi">2</span><span class="p">),</span> <span class="nx">calmode</span><span class="p">.</span><span class="nx">nexttoday</span><span class="p">),</span> <span class="nx">o</span><span class="p">.</span><span class="nx">blackDates</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
                                        <span class="nx">skipThis</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="nx">skipThis</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span> <span class="p">}</span>

                                <span class="k">if</span> <span class="p">(</span> <span class="nx">gridWeek</span> <span class="o">===</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">{</span>
                                    <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;&lt;div&gt;&quot;</span><span class="o">+</span><span class="nb">String</span><span class="p">(</span><span class="nx">calmode</span><span class="p">.</span><span class="nx">prevtoday</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;&lt;/div&gt;&quot;</span><span class="p">)</span>
                                        <span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="s1">&#39;ui-cp-date ui-cp-date-disabled&#39;</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">thisRow</span><span class="p">)</span>
                                        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;data-date&#39;</span><span class="p">,</span> <span class="p">((</span><span class="nx">o</span><span class="p">.</span><span class="nx">calWeekMode</span><span class="p">)</span><span class="o">?</span><span class="p">(</span><span class="nx">calmode</span><span class="p">.</span><span class="nx">weekMode</span><span class="o">+</span><span class="nx">calmode</span><span class="p">.</span><span class="nx">lastend</span><span class="p">)</span><span class="o">:</span><span class="nx">calmode</span><span class="p">.</span><span class="nx">prevtoday</span><span class="p">));</span>
                                    <span class="nx">calmode</span><span class="p">.</span><span class="nx">prevtoday</span><span class="o">++</span><span class="p">;</span>
                                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                                    <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;&lt;div&gt;&quot;</span><span class="o">+</span><span class="nb">String</span><span class="p">(</span><span class="nx">calmode</span><span class="p">.</span><span class="nx">nexttoday</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;&lt;/div&gt;&quot;</span><span class="p">)</span>
                                        <span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="s1">&#39;ui-cp-date ui-cp-date-disabled&#39;</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">thisRow</span><span class="p">)</span>
                                        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;data-date&#39;</span><span class="p">,</span> <span class="p">((</span><span class="nx">o</span><span class="p">.</span><span class="nx">calWeekMode</span><span class="p">)</span><span class="o">?</span><span class="nx">calmode</span><span class="p">.</span><span class="nx">weekMode</span><span class="o">:</span><span class="nx">calmode</span><span class="p">.</span><span class="nx">nexttoday</span><span class="p">));</span>
                                    <span class="nx">calmode</span><span class="p">.</span><span class="nx">nexttoday</span><span class="o">++</span><span class="p">;</span>
                                <span class="p">}</span>
                            <span class="p">}</span>
                        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                            <span class="nx">skipThis</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
                            <span class="k">if</span> <span class="p">(</span> <span class="nx">calmode</span><span class="p">.</span><span class="nx">checkDates</span> <span class="p">)</span> <span class="p">{</span>
                                <span class="k">if</span> <span class="p">(</span> <span class="nx">o</span><span class="p">.</span><span class="nx">afterToday</span> <span class="o">&amp;&amp;</span> <span class="nx">self</span><span class="p">.</span><span class="nx">_checker</span><span class="p">(</span><span class="nx">calmode</span><span class="p">.</span><span class="nx">thisDate</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">_checker</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">theDate</span><span class="p">)</span><span class="o">+</span><span class="nx">calmode</span><span class="p">.</span><span class="nx">today</span><span class="o">-</span><span class="nx">self</span><span class="p">.</span><span class="nx">theDate</span><span class="p">.</span><span class="nx">getDate</span><span class="p">())</span> <span class="p">)</span> <span class="p">{</span>
                                    <span class="nx">skipThis</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                                <span class="p">}</span>
                                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nx">skipThis</span> <span class="o">&amp;&amp;</span> <span class="nx">o</span><span class="p">.</span><span class="nx">beforeToday</span> <span class="o">&amp;&amp;</span> <span class="nx">self</span><span class="p">.</span><span class="nx">_checker</span><span class="p">(</span><span class="nx">calmode</span><span class="p">.</span><span class="nx">thisDate</span><span class="p">)</span> <span class="o">&lt;</span> <span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">_checker</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">theDate</span><span class="p">)</span><span class="o">+</span><span class="nx">calmode</span><span class="p">.</span><span class="nx">today</span><span class="o">-</span><span class="nx">self</span><span class="p">.</span><span class="nx">theDate</span><span class="p">.</span><span class="nx">getDate</span><span class="p">())</span> <span class="p">)</span> <span class="p">{</span>
                                    <span class="nx">skipThis</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                                <span class="p">}</span>
                                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nx">skipThis</span> <span class="o">&amp;&amp;</span> <span class="nx">o</span><span class="p">.</span><span class="nx">notToday</span> <span class="o">&amp;&amp;</span> <span class="nx">calmode</span><span class="p">.</span><span class="nx">today</span> <span class="o">===</span> <span class="nx">calmode</span><span class="p">.</span><span class="nx">highlightDay</span> <span class="p">)</span> <span class="p">{</span>
                                    <span class="nx">skipThis</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                                <span class="p">}</span>
                                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nx">skipThis</span> <span class="o">&amp;&amp;</span> <span class="nx">o</span><span class="p">.</span><span class="nx">maxDays</span> <span class="o">!==</span> <span class="kc">false</span> <span class="o">&amp;&amp;</span> <span class="nx">self</span><span class="p">.</span><span class="nx">_checker</span><span class="p">(</span><span class="nx">calmode</span><span class="p">.</span><span class="nx">maxDate</span><span class="p">)</span> <span class="o">&lt;</span> <span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">_checker</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">theDate</span><span class="p">)</span><span class="o">+</span><span class="nx">calmode</span><span class="p">.</span><span class="nx">today</span><span class="o">-</span><span class="nx">self</span><span class="p">.</span><span class="nx">theDate</span><span class="p">.</span><span class="nx">getDate</span><span class="p">())</span> <span class="p">)</span> <span class="p">{</span>
                                    <span class="nx">skipThis</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                                <span class="p">}</span>
                                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nx">skipThis</span> <span class="o">&amp;&amp;</span> <span class="nx">o</span><span class="p">.</span><span class="nx">minDays</span> <span class="o">!==</span> <span class="kc">false</span> <span class="o">&amp;&amp;</span> <span class="nx">self</span><span class="p">.</span><span class="nx">_checker</span><span class="p">(</span><span class="nx">calmode</span><span class="p">.</span><span class="nx">minDate</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">_checker</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">theDate</span><span class="p">)</span><span class="o">+</span><span class="nx">calmode</span><span class="p">.</span><span class="nx">today</span><span class="o">-</span><span class="nx">self</span><span class="p">.</span><span class="nx">theDate</span><span class="p">.</span><span class="nx">getDate</span><span class="p">())</span> <span class="p">)</span> <span class="p">{</span>
                                    <span class="nx">skipThis</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                                <span class="p">}</span>
                                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nx">skipThis</span> <span class="o">&amp;&amp;</span> <span class="p">(</span> <span class="nx">o</span><span class="p">.</span><span class="nx">blackDays</span> <span class="o">!==</span> <span class="kc">false</span> <span class="o">||</span> <span class="nx">o</span><span class="p">.</span><span class="nx">blackDates</span> <span class="o">!==</span> <span class="kc">false</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span> <span class="c1">// Blacklists</span>
                                    <span class="k">if</span> <span class="p">(</span>
                                        <span class="p">(</span> <span class="nx">$</span><span class="p">.</span><span class="nx">inArray</span><span class="p">(</span><span class="nx">gridDay</span><span class="p">,</span> <span class="nx">o</span><span class="p">.</span><span class="nx">blackDays</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span> <span class="p">)</span> <span class="o">||</span>
                                        <span class="p">(</span> <span class="nx">$</span><span class="p">.</span><span class="nx">inArray</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">_isoDate</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">theDate</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">(),</span> <span class="nx">self</span><span class="p">.</span><span class="nx">theDate</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nx">calmode</span><span class="p">.</span><span class="nx">today</span><span class="p">),</span> <span class="nx">o</span><span class="p">.</span><span class="nx">blackDates</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
                                            <span class="nx">skipThis</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                                    <span class="p">}</span>
                                <span class="p">}</span>
                            <span class="p">}</span>

                            <span class="k">if</span> <span class="p">(</span> <span class="nx">o</span><span class="p">.</span><span class="nx">calHighToday</span> <span class="o">!==</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="nx">calmode</span><span class="p">.</span><span class="nx">today</span> <span class="o">===</span> <span class="nx">calmode</span><span class="p">.</span><span class="nx">highlightDay</span> <span class="p">)</span> <span class="p">{</span>
                                <span class="nx">calmode</span><span class="p">.</span><span class="nx">thisTheme</span> <span class="o">=</span> <span class="nx">o</span><span class="p">.</span><span class="nx">calHighToday</span><span class="p">;</span>
                            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="nx">$</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">o</span><span class="p">.</span><span class="nx">highDates</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">inArray</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">_isoDate</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">theDate</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">(),</span> <span class="nx">self</span><span class="p">.</span><span class="nx">theDate</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nx">calmode</span><span class="p">.</span><span class="nx">today</span><span class="p">),</span> <span class="nx">o</span><span class="p">.</span><span class="nx">highDates</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
                                <span class="nx">calmode</span><span class="p">.</span><span class="nx">thisTheme</span> <span class="o">=</span> <span class="nx">o</span><span class="p">.</span><span class="nx">highDatesTheme</span><span class="p">;</span>
                            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="nx">$</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">o</span><span class="p">.</span><span class="nx">highDays</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">$</span><span class="p">.</span><span class="nx">inArray</span><span class="p">(</span><span class="nx">o</span><span class="p">.</span><span class="nx">daysOfWeekShort</span><span class="p">[</span><span class="nx">gridDay</span><span class="o">+</span><span class="nx">o</span><span class="p">.</span><span class="nx">calStartDay</span><span class="p">],</span> <span class="nx">o</span><span class="p">.</span><span class="nx">highDays</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span> <span class="p">)</span> <span class="p">{</span>
                                  <span class="kd">var</span> <span class="nx">index</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">inArray</span><span class="p">(</span><span class="nx">o</span><span class="p">.</span><span class="nx">daysOfWeekShort</span><span class="p">[</span><span class="nx">gridDay</span><span class="o">+</span><span class="nx">o</span><span class="p">.</span><span class="nx">calStartDay</span><span class="p">],</span> <span class="nx">o</span><span class="p">.</span><span class="nx">highDays</span><span class="p">);</span>
                                  <span class="kd">var</span> <span class="nx">theme</span> <span class="o">=</span> <span class="s2">&quot;calendarbutton&quot;</span><span class="p">;</span>
                                  <span class="nx">index</span> <span class="o">=</span> <span class="nx">index</span> <span class="o">==</span> <span class="nx">o</span><span class="p">.</span><span class="nx">highDays</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span> <span class="o">?</span> <span class="o">-</span><span class="mi">1</span> <span class="o">:</span><span class="nx">index</span><span class="p">;</span>
                                  <span class="k">if</span> <span class="p">(</span><span class="nx">index</span><span class="o">&gt;-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                                      <span class="kd">var</span> <span class="nx">temp</span> <span class="o">=</span> <span class="nx">o</span><span class="p">.</span><span class="nx">highDays</span><span class="p">[</span><span class="nx">index</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>
                                      <span class="k">if</span> <span class="p">(</span><span class="nb">isNaN</span><span class="p">(</span><span class="nx">temp</span><span class="p">))</span>
                                          <span class="nx">theme</span> <span class="o">=</span> <span class="nx">temp</span><span class="p">;</span>
                                  <span class="p">}</span>
                                <span class="nx">calmode</span><span class="p">.</span><span class="nx">thisTheme</span> <span class="o">=</span> <span class="nx">o</span><span class="p">.</span><span class="nx">highDays</span><span class="p">[</span><span class="nx">index</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>
                            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                                <span class="nx">calmode</span><span class="p">.</span><span class="nx">thisTheme</span> <span class="o">=</span> <span class="s2">&quot;calendarbutton&quot;</span><span class="p">;</span>
                            <span class="p">}</span>


                            <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;&lt;div&gt;&quot;</span><span class="o">+</span><span class="nb">String</span><span class="p">(</span><span class="nx">calmode</span><span class="p">.</span><span class="nx">today</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;&lt;/div&gt;&quot;</span><span class="p">)</span>
                                <span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="s1">&#39;ui-cp-date ui-calendarbtncommon&#39;</span><span class="p">)</span>
                                <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;data-date&#39;</span><span class="p">,</span> <span class="p">((</span><span class="nx">o</span><span class="p">.</span><span class="nx">calWeekMode</span><span class="p">)</span><span class="o">?</span><span class="nx">calmode</span><span class="p">.</span><span class="nx">weekMode</span><span class="o">:</span><span class="nx">calmode</span><span class="p">.</span><span class="nx">today</span><span class="p">))</span>
                                <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;data-theme&#39;</span><span class="p">,</span> <span class="nx">calmode</span><span class="p">.</span><span class="nx">thisTheme</span><span class="p">)</span>
                                <span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">thisRow</span><span class="p">)</span>
                                <span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="s1">&#39;ui-btn-up-&#39;</span><span class="o">+</span><span class="nx">calmode</span><span class="p">.</span><span class="nx">thisTheme</span><span class="p">)</span>
                                <span class="p">.</span><span class="nx">unbind</span><span class="p">().</span><span class="nx">bind</span><span class="p">((</span><span class="o">!</span><span class="nx">skipThis</span><span class="p">)</span><span class="o">?</span><span class="s1">&#39;vclick&#39;</span><span class="o">:</span><span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
                                        <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
                                        <span class="nx">self</span><span class="p">.</span><span class="nx">theDate</span><span class="p">.</span><span class="nx">setDate</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;data-date&#39;</span><span class="p">));</span>
                                        <span class="nx">self</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s1">&#39;selectedDate&#39;</span><span class="p">,[</span><span class="nx">self</span><span class="p">.</span><span class="nx">_formatDate</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">theDate</span><span class="p">)]);</span>
                                        <span class="nx">self</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
                                <span class="p">})</span>
                                <span class="p">.</span><span class="nx">css</span><span class="p">((</span><span class="nx">skipThis</span><span class="p">)</span><span class="o">?</span><span class="s1">&#39;color&#39;</span><span class="o">:</span><span class="s1">&#39;nocolor&#39;</span><span class="p">,</span> <span class="nx">o</span><span class="p">.</span><span class="nx">disabledDayColor</span><span class="p">);</span>

                            <span class="nx">calmode</span><span class="p">.</span><span class="nx">today</span><span class="o">++</span><span class="p">;</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">},</span>

        <span class="nx">_create</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <p>Create the widget, called automatically by widget system</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">,</span>
                <span class="nx">o</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;options&#39;</span><span class="p">)),</span>
                <span class="nx">input</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">,</span>
                <span class="nx">theDate</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span> <span class="c1">// Internal date object, used for all operations</span>
            <span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">self</span><span class="p">,</span> <span class="p">{</span>
                     <span class="nx">input</span><span class="o">:</span><span class="nx">input</span><span class="p">,</span>
                     <span class="nx">theDate</span><span class="o">:</span> <span class="nx">theDate</span>
            <span class="p">});</span>

            <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">).</span><span class="nx">buttonMarkup</span><span class="p">();</span>

            <span class="nx">self</span><span class="p">.</span><span class="nx">_buildPage</span><span class="p">();</span>
        <span class="p">},</span>

        <span class="nx">_htmlProto</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">ui</span><span class="o">:</span> <span class="p">{</span>
                <span class="nx">cpContainer</span><span class="o">:</span>    <span class="s2">&quot;.ui-cp-container&quot;</span><span class="p">,</span>
                <span class="nx">cpHeader</span><span class="o">:</span>       <span class="s2">&quot;.ui-cp-headercontainer&quot;</span><span class="p">,</span>
                <span class="nx">cpweekDayGrid</span><span class="o">:</span>  <span class="s2">&quot;.ui-cp-weekday&quot;</span><span class="p">,</span>
                <span class="nx">cpMonthGrid</span><span class="o">:</span>    <span class="s2">&quot;.ui-cp-month&quot;</span><span class="p">,</span>
                <span class="nx">previousButton</span><span class="o">:</span> <span class="s2">&quot;.ui-cp-previous&quot;</span><span class="p">,</span>
                <span class="nx">nextButton</span><span class="o">:</span>     <span class="s2">&quot;.ui-cp-next&quot;</span>
            <span class="p">}</span>
        <span class="p">},</span>

        <span class="nx">_buildPage</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <p>Build the controls</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">,</span>
                <span class="nx">o</span> <span class="o">=</span> <span class="nx">self</span><span class="p">.</span><span class="nx">options</span><span class="p">,</span>
                <span class="nx">isopen</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
                <span class="nx">previousButtonMarkup</span> <span class="o">=</span> <span class="p">{</span><span class="nx">inline</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
                                        <span class="nx">corners</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span>
                                        <span class="nx">icon</span><span class="o">:</span><span class="s1">&#39;arrow-l&#39;</span><span class="p">,</span>
                                        <span class="nx">iconpos</span><span class="o">:</span><span class="s1">&#39;notext&#39;</span><span class="p">},</span>
                <span class="nx">nextButtonMarkup</span> <span class="o">=</span> <span class="p">{</span><span class="nx">inline</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
                                    <span class="nx">corners</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span>
                                    <span class="nx">icon</span><span class="o">:</span><span class="s1">&#39;arrow-r&#39;</span><span class="p">,</span>
                                    <span class="nx">iconpos</span><span class="o">:</span><span class="s1">&#39;notext&#39;</span><span class="p">};</span>

            <span class="k">this</span><span class="p">.</span><span class="nx">_ui</span><span class="p">.</span><span class="nx">previousButton</span><span class="p">.</span><span class="nx">buttonMarkup</span><span class="p">(</span><span class="nx">previousButtonMarkup</span><span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">_ui</span><span class="p">.</span><span class="nx">nextButton</span><span class="p">.</span><span class="nx">buttonMarkup</span><span class="p">(</span><span class="nx">nextButtonMarkup</span><span class="p">);</span>

            <span class="k">this</span><span class="p">.</span><span class="nx">_ui</span><span class="p">.</span><span class="nx">nextButton</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="s1">&#39;vclick&#39;</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">self</span><span class="p">.</span><span class="nx">calNoNext</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span> <span class="nx">self</span><span class="p">.</span><span class="nx">theDate</span><span class="p">.</span><span class="nx">getDate</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">28</span> <span class="p">)</span> <span class="p">{</span> <span class="nx">self</span><span class="p">.</span><span class="nx">theDate</span><span class="p">.</span><span class="nx">setDate</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="p">}</span>
                    <span class="nx">self</span><span class="p">.</span><span class="nx">_offset</span><span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">});</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">_ui</span><span class="p">.</span><span class="nx">previousButton</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="s1">&#39;vclick&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">self</span><span class="p">.</span><span class="nx">calNoPrev</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span> <span class="nx">self</span><span class="p">.</span><span class="nx">theDate</span><span class="p">.</span><span class="nx">getDate</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">28</span> <span class="p">)</span> <span class="p">{</span> <span class="nx">self</span><span class="p">.</span><span class="nx">theDate</span><span class="p">.</span><span class="nx">setDate</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="p">}</span>
                    <span class="nx">self</span><span class="p">.</span><span class="nx">_offset</span><span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">});</span>

            <span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">self</span><span class="p">,</span> <span class="p">{</span>
                <span class="nx">isopen</span><span class="o">:</span><span class="nx">isopen</span>
            <span class="p">});</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">_ui</span><span class="p">.</span><span class="nx">cpContainer</span><span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">element</span><span class="p">)</span>
                       <span class="p">.</span><span class="nx">popupwindow</span><span class="p">({</span><span class="nx">transition</span><span class="o">:</span> <span class="s2">&quot;slideup&quot;</span><span class="p">,</span> <span class="nx">overlayTheme</span><span class="o">:</span> <span class="s2">&quot;c&quot;</span><span class="p">})</span>
                       <span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="s2">&quot;closed&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
                          <span class="nx">self</span><span class="p">.</span><span class="nx">isopen</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
                       <span class="p">});</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">o</span><span class="p">.</span><span class="nx">show</span><span class="p">)</span>
                <span class="nx">self</span><span class="p">.</span><span class="nx">open</span><span class="p">();</span>
        <span class="p">},</span>

        <span class="nx">refresh</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">_update</span><span class="p">();</span>
        <span class="p">},</span>

        <span class="nx">visible</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">isopen</span><span class="p">;</span>
        <span class="p">},</span>

        <span class="nx">open</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <p>Open the picker</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">isopen</span> <span class="o">===</span> <span class="kc">true</span> <span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span> <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">isopen</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span> <span class="p">}</span> <span class="c1">// Ignore if already open</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">_update</span><span class="p">();</span>
            <span class="cm">/*</span>
<span class="cm">             * FIXME: Could pass some meaningful coordinates to &quot;open&quot; to make it show up in the right place, rather</span>
<span class="cm">             * than the center of the screen. The problem is that no widget from the page is associated with this</span>
<span class="cm">             * popup window, so we would have to start with this.element and work our way up the tree until we ran</span>
<span class="cm">             * into a widget whose coordinates we could actually pass to &quot;open&quot;.</span>
<span class="cm">             */</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">_ui</span><span class="p">.</span><span class="nx">cpContainer</span><span class="p">.</span><span class="nx">popupwindow</span><span class="p">(</span><span class="s2">&quot;open&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerHeight</span><span class="p">);</span>
        <span class="p">},</span>

        <span class="nx">close</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <p>Close the picker</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="k">this</span><span class="p">.</span><span class="nx">_ui</span><span class="p">.</span><span class="nx">cpContainer</span><span class="p">.</span><span class="nx">popupwindow</span><span class="p">(</span><span class="s2">&quot;close&quot;</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <p>Autoinit widget.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">$</span><span class="p">(</span> <span class="nb">document</span> <span class="p">).</span><span class="nx">bind</span><span class="p">(</span> <span class="s2">&quot;pagecreate&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">e</span> <span class="p">){</span>
        <span class="nx">$</span><span class="p">(</span> <span class="s2">&quot;:jqmData(role=&#39;calendarpicker&#39;)&quot;</span><span class="p">,</span> <span class="nx">e</span><span class="p">.</span><span class="nx">target</span> <span class="p">).</span><span class="nx">calendarpicker</span><span class="p">();</span>
    <span class="p">});</span>

<span class="p">})(</span> <span class="nx">jQuery</span> <span class="p">);</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 